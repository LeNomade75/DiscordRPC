import psutil
import subprocess
import time
import os
import signal
import sys
print(r"""⡟⠀⠀⠀⠀⢻⣧⠀⠀⠀⠀⠀⠀⠀⠀⠐⠀⣠⢔⡾⠛⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠂⢠⡀⠀⢠⠶⠬⢭⡴⠖⢲⣯⣼⢷⡏⠉⢹⡯⠿⠿⡿⠿⠥
⠃⠀⠀⠀⠠⠴⠟⠃⠚⠛⠃⠲⠶⢦⠀⠀⣨⣷⠊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⠻⠿⡝⢧⣀⣼⣁⣠⣾⠟⣻⣼⣧⢤⣼⣤⣄⣀⠀⣀⠀
⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⢨⢿⣿⠿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢻⣿⣿⣿⣯⠴⠋⠉⠀⠀⠀⠀⠀⠀⠈⠙⠶⣤
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⠿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⢃⠿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡜⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠏⠀⠀⠀⠀⢰⣷⡆⠀⠀⠀⡂⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡼⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠁⠀⠀⠀⠀⠀⠈⣿⡇⠀⠀⣠⣧⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⡜⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠏⠀⠀⠀⠀⠀⡆⠀⠀⠀⠀⠀⠀⠀⣸⠇⠀⠀⠀⠀⠀⠀⠀⠿⣿⠀⠀⠽⠻⡀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢰⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡞⠀⠀⠀⠀⠀⢸⢇⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠰⢖⣶⠀⠀⣶⢾⡇⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⡞⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡞⠀⠀⠀⠀⠀⡤⠀⠀⠀⠀⣼⠁⠀⠀⠀⠀⠀⡞⢸⠦⣄⣀⠀⠀⣀⣸⠁⠀⠀⠀⠀⠀⠀⠀⠠⣮⡄⠀⠀⣤⣄⡀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢰⠃⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⡇⢀⠀⠀⠀⢠⠃⠀⠀⠀⢰⠃⠀⠀⠀⠀⠀⢰⠃⠘⡄⢈⣩⠷⠿⢭⣽⠀⠀⠀⠀⠀⠀⠀⠀⢸⠿⡇⠀⠀⢛⣏⠁⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⢸⠀⠀⠀⠀⢰⠀⢸⠀⠀⠇⢸⠀⠀⠀⢠⡏⠀⠀⠀⠀⠀⢠⡏⠀⠀⢻⠋⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⢻⡿⠗⠀⠀⠾⡅⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡟⠀⠀⠀⠀⠀⢸⠀⡀⠀⠀⢸⠀⡆⠀⢸⠀⡇⠀⠀⡀⡸⠁⠀⠀⠀⠀⠐⡾⠄⡀⠀⠈⣇⠀⠀⠀⠠⡇⠀⠀⠀⠀⠀⠀⠀⠀⢰⡤⣄⠀⠀⣰⣇⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⣸⠀⡇⠀⠀⢸⢠⡇⠀⢘⢠⠃⠀⢸⢁⡇⠀⠀⠀⠀⠀⣼⠁⠀⠀⠀⠀⠸⡄⠀⠀⣼⡇⠀⠀⠀⠀⠀⠀⠀⠀⢈⣇⣣⠀⠈⠛⠛⠃⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡇⡇⠀⠀⡇⠀⣿⠀⡇⠀⣿⣈⢸⠁⠀⣼⣸⠀⠀⡎⢸⠃⠀⠀⠀⠀⣼⣧⣄⡢⠄⠀⠀⠀⢳⣠⠀⣿⢹⠀⠀⠀⠀⠀⠀⠀⠀⠻⠿⣟⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡇⡇⠀⠀⡇⠀⣿⡇⢃⠀⣿⣿⣸⠀⠀⣿⣿⠀⠀⡇⡏⠀⠀⠀⠀⡼⠟⣻⣿⣿⣦⣄⠀⠀⠀⣯⠘⠛⢻⡀⠀⠀⠀⠀⠀⠀⠀⠶⣿⠟⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⡇⣷⡀⠀⢃⠀⡟⣿⠸⡆⠉⣿⣿⠄⠀⣿⡏⠀⢀⢷⡇⠀⠀⠀⡼⠁⠀⣿⣿⣿⣿⣿⢿⠂⠀⣿⠀⠀⣌⣧⠀⠀⠀⠀⠀⠀⠀⣠⣍⣀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣿⡟⣇⠀⢾⣦⢹⢹⡄⠻⠀⠸⡿⢷⠀⣿⣿⠀⢸⣸⠃⠀⢀⠞⠁⠀⠀⣇⠀⠛⣠⢏⠼⠃⣴⠃⢀⣾⣿⣾⢇⠀⠀⠀⠀⠀⠀⢾⣿⡋⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠹⣇⠘⣆⠸⣿⣸⣿⣇⠀⠀⠀⠀⠀⠀⠈⠛⠃⠈⠿⠀⡴⠋⠀⠀⠀⠐⠊⠛⠋⠁⠀⠀⡼⠁⣠⡿⠃⣰⠃⠈⢧⡀⠀⠀⠀⠀⠐⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠘⠆⠘⢦⡻⣷⡹⡿⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠂⠀⠀⠀⠀⢠⠞⢁⡾⣛⣤⡞⠁⠀⠀⣠⢟⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⢷⣷⣵⡽⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠰⠋⢀⣼⡿⣻⠟⠀⣠⠴⠚⠓⠉⠈⠳⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀                                               
⠀⠀⠠⣤⡀⣠⡴⠋⠱⡄⠀⠀⠀⠀⠀⠉⠻⣽⣿⣦⣀⠀⠀⠀⠀⠀⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⢫⡾⢃⣤⠾⠛⠀⠀⠀⠀⠀⠀⠀⠙⠲⠶⠤⠤⠤⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠙⢧⡀⠀⠀⢸⡀⠀⠀⠀⠀⠀⠀⠀⠀⣽⢿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣶⣾⣽⠿⠾⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠈⠳⣄⠀⠀⣇⠀⠀⠀⠀⠀⠀⠀⠀⢸⣟⠙⣿⡙⠻⣦⣀⣀⣤⣤⣴⣿⣿⣿⣿⢿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⠤⢶⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢰⠀⠀⠀⠀⠀⠀⠘⢦⠀⢸⡄⣀⣄⠀⢀⣠⠤⠖⠚⣇⠀⠀⠙⢆⠙⠛⣿⣿⡟⠋⠙⠿⠀⣟⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠖⠋⠀⠀⠾⠤⠖⠲⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢸⠀⠀⠀⠀⠀⠀⠀⠈⣷⢯⠉⠓⢬⠏⠉⠀⠀⠀⠀⠸⣄⠀⠀⠘⡆⠀⡴⠋⠀⠀⠀⡦⢸⡿⣄⠀⠀⠀⠀⠀⠀⠀⣠⠞⠁⠀⠀⠀⠀⠀⠀⠀⢠⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢸⡀⠀⠀⠀⠀⠀⠀⠀⢹⠓⠶⠤⣼⡀⠀⢀⣀⠀⠀⠀⠙⢧⡀⠀⢿⡸⠁⠀⠀⠀⣸⣱⠟⠁⠈⠓⠦⣄⣀⣀⣤⡾⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⡼⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢷⡀⠀⠀⠀⠀⠀⠀⠀⢧⡀⠀⠸⣧⠀⠀⠀⠁⠀⠀⠀⠀⠙⠂⠘⡇⠠⠤⠖⠀⠁⠀⠀⠀⠀⠀⣠⡾⠭⣠⠟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⡠⠽⠷⠤⣀⡀⠀⠀⠀⣸⣿⡟⠋⠈⠳⣄⠀⠀⠀⢲⡞⠛⢉⣭⡿⣿⡛⠛⠦⣤⣀⠀⠀⢀⢴⡾⠋⠀⢀⣼⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠁⠀⠀⠀⠀⠁⠀⠀⢤⣿⠃⠹⣄⠀⠀⠻⣶⣤⣀⠀⠻⠒⢫⡟⠀⢹⡝⢶⣄⣰⣟⣤⠾⠟⠣⣄⣀⣤⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⣠⡾⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⡆⠀⠀⠀⠀⠀⠀⢀⣼⠃⠀⠀⠈⠑⢦⡚⠀⠉⠚⢿⣶⣦⣿⣀⣄⣈⣧⠤⠞⣯⡉⠀⠀⣀⣾⠿⠓⢺⣿⡇⠀⠀⠀⠒⠒⠒⠂⢻⡉⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠰⢣⡀⠀⠀⠀⠀⠀⣸⡇⠀⠀⠀⠀⠀⠀⠉⠲⠶⠼⢇⠀⡾⠀⠀⣴⠀⢹⠀⣀⣤⡷⠶⠞⠋⠁⠀⠀⢸⣿⡇⠀⠀⠀⠀⠀⠀⠀⢸⠃⠸⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⢧⣤⠄⠀⠀⢀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣹⠗⠒⠒⠛⠒⢺⠛⠛⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⡇⠀⠀⠀⠀⠀⠀⢀⡟⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠈⢻⠃⠀⢀⡜⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠀⠀⠀⠀⠀⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⡇⠀⠀⠀⠀⢀⡴⠏⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

 /$$$$$$$  /$$$$$$  /$$$$$$   /$$$$$$   /$$$$$$  /$$$$$$$  /$$$$$$$        /$$$$$$$  /$$$$$$$   /$$$$$$ 
| $$__  $$|_  $$_/ /$$__  $$ /$$__  $$ /$$__  $$| $$__  $$| $$__  $$      | $$__  $$| $$__  $$ /$$__  $$
| $$  \ $$  | $$  | $$  \__/| $$  \__/| $$  \ $$| $$  \ $$| $$  \ $$      | $$  \ $$| $$  \ $$| $$  \__/
| $$  | $$  | $$  |  $$$$$$ | $$      | $$  | $$| $$$$$$$/| $$  | $$      | $$$$$$$/| $$$$$$$/| $$      
| $$  | $$  | $$   \____  $$| $$      | $$  | $$| $$__  $$| $$  | $$      | $$__  $$| $$____/ | $$      
| $$  | $$  | $$   /$$  \ $$| $$    $$| $$  | $$| $$  \ $$| $$  | $$      | $$  \ $$| $$      | $$    $$
| $$$$$$$/ /$$$$$$|  $$$$$$/|  $$$$$$/|  $$$$$$/| $$  | $$| $$$$$$$/      | $$  | $$| $$      |  $$$$$$/
|_______/ |______/ \______/  \______/  \______/ |__/  |__/|_______/       |__/  |__/|__/       \______/                                                                                                                                                       
                                           ____  _  _    __    ____  __ _   __   _  _   __   ____  ____ 
                                          (  _ \( \/ )  (  )  (  __)(  ( \ /  \ ( \/ ) / _\ (    \(  __)
                                           ) _ ( )  /   / (_/\ ) _) /    /(  O )/ \/ \/    \ ) D ( ) _) 
                                          (____/(__/    \____/(____)\_)__) \__/ \_)(_/\_/\_/(____/(____)        
       """) 
PROGRAM_SCRIPTS = {
    "euphoria.exe": "euphoria.py",
    "lenomduprogramedanslegestionnairedestaches.exe": "lenomducript.py",
    "chrome.exe": "deaddays.py"
}

current_process = None

def get_running_program(programs):
    running = set()
    for p in psutil.process_iter(['name']):
        try:
            if p.info['name']:
                running.add(p.info['name'].lower())
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass
    for program in programs:
        if program.lower() in running:
            return program
    return None

def main():
    global current_process
    last_program = None

    while True:
        program = get_running_program(PROGRAM_SCRIPTS.keys())
        if program != last_program:
            print("Detected program:", program)  # Debug

        if program != last_program:
            if current_process and current_process.poll() is None:
                print("Killing previous RPC process...")
                if os.name == "nt":
                    current_process.send_signal(signal.CTRL_BREAK_EVENT)
                    time.sleep(0.5)
                    current_process.terminate()
                else:
                    current_process.terminate()
                current_process.wait()
                current_process = None

            if program:
                script = os.path.abspath(PROGRAM_SCRIPTS[program])
                print(f"Starting RPC for {program} -> {script}")
                if os.name == "nt":
                    current_process = subprocess.Popen(
                        [sys.executable, script],
                        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP
                    )
                else:
                    current_process = subprocess.Popen([sys.executable, script])
            else:
                print("No tracked program running, RPC cleared")

            last_program = program

        time.sleep(10)

if __name__ == "__main__":
    main()

